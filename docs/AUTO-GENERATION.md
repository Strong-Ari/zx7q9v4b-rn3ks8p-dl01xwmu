# GÃ©nÃ©ration Automatique de Commentaires TikTok

## ğŸš€ FonctionnalitÃ©

Le systÃ¨me gÃ©nÃ¨re maintenant automatiquement un nouveau commentaire TikTok Ã  chaque fois que :

- Vous lancez le serveur de dÃ©veloppement (`npm run dev`)
- Vous rafraÃ®chissez la page dans le navigateur

## ğŸ“‹ Comment Ã§a marche

### 1. **Au dÃ©marrage du serveur**

```bash
npm run dev
```

Le script `predev` se lance automatiquement avant le serveur Next.js :

- ExÃ©cute `scripts/generate-comment-startup.ts`
- GÃ©nÃ¨re un commentaire TikTok avec nom fixe : `tiktok-comment-current.png`
- Supprime l'ancienne image automatiquement

### 2. **Au chargement/rafraÃ®chissement de la page**

Le hook `useAutoGeneratedComment` :

- Se dÃ©clenche automatiquement au montage du composant
- Appelle l'API `/api/generate-tiktok-comment`
- Met Ã  jour l'image en temps rÃ©el
- Affiche le statut de gÃ©nÃ©ration dans l'UI

## ğŸ›ï¸ Interface utilisateur

### Indicateur de statut

La page affiche maintenant :

- **ğŸ”„ GÃ©nÃ©ration en cours** : Spinner animÃ© + message
- **âœ… SuccÃ¨s** : Pseudo et commentaire gÃ©nÃ©rÃ©s
- **âŒ Erreur** : Message d'erreur dÃ©taillÃ©
- **ğŸ”„ Bouton "RÃ©gÃ©nÃ©rer"** : Pour gÃ©nÃ©rer un nouveau commentaire manuellement

### Informations affichÃ©es

- Pseudo gÃ©nÃ©rÃ© (ex: `lil.princess`)
- Commentaire gÃ©nÃ©rÃ© (ex: `"would u tell ur crush u dreamt abt them ?"`)
- Statut de la gÃ©nÃ©ration en temps rÃ©el

## ğŸ”§ Fichiers modifiÃ©s

### 1. **Hook personnalisÃ©** : `src/hooks/useAutoGeneratedComment.ts`

- Gestion de l'Ã©tat de gÃ©nÃ©ration
- Appel automatique au montage
- Interface pour rÃ©gÃ©nÃ©ration manuelle

### 2. **Page principale** : `src/app/page.tsx`

- IntÃ©gration du hook
- UI de statut de gÃ©nÃ©ration
- Bouton de rÃ©gÃ©nÃ©ration

### 3. **Composition vidÃ©o** : `src/remotion/BallEscape.tsx`

- Cache-busting pour forcer le rechargement de l'image
- Timestamp ajoutÃ© Ã  l'URL de l'image

### 4. **Scripts** :

- `scripts/generate-comment-startup.ts` : GÃ©nÃ©ration au dÃ©marrage
- `package.json` : Script `predev` ajoutÃ©

## ğŸ¯ Avantages

### âœ… **ExpÃ©rience utilisateur fluide**

- Pas besoin de commandes manuelles
- Commentaire toujours frais au dÃ©marrage
- RÃ©gÃ©nÃ©ration Ã  la demande

### âœ… **DÃ©veloppement optimisÃ©**

- GÃ©nÃ©ration automatique au `npm run dev`
- Feedback visuel en temps rÃ©el
- Gestion d'erreurs intÃ©grÃ©e

### âœ… **SystÃ¨me robuste**

- Retry automatique en cas d'Ã©chec
- Fallback sur l'ancienne image en cas d'erreur
- Cache-busting pour Ã©viter les images obsolÃ¨tes

## ğŸ› ï¸ Commandes disponibles

### GÃ©nÃ©ration manuelle

```bash
# GÃ©nÃ©ration complÃ¨te avec logs dÃ©taillÃ©s
npm run generate:comment

# GÃ©nÃ©ration rapide (utilisÃ©e au dÃ©marrage)
npm run generate:startup
```

### DÃ©veloppement

```bash
# Lance le serveur + gÃ©nÃ¨re un commentaire automatiquement
npm run dev

# Juste le serveur (sans gÃ©nÃ©ration prÃ©alable)
npx next dev
```

## ğŸ” Troubleshooting

### La gÃ©nÃ©ration ne se lance pas au dÃ©marrage

- VÃ©rifiez que Playwright est installÃ© : `npx playwright install chromium`
- VÃ©rifiez la connexion internet

### L'image ne se met pas Ã  jour dans la vidÃ©o

- Le cache-busting devrait rÃ©soudre ce problÃ¨me automatiquement
- En cas de problÃ¨me, rechargez la page complÃ¨tement (Ctrl+F5)

### Erreur de gÃ©nÃ©ration

- Cliquez sur "RÃ©gÃ©nÃ©rer" dans l'interface
- VÃ©rifiez les logs de la console du navigateur
- VÃ©rifiez que l'API `/api/generate-tiktok-comment` fonctionne

## ğŸ¬ Workflow recommandÃ©

1. **DÃ©marrer le dÃ©veloppement** :

   ```bash
   npm run dev
   ```

   â†³ Un commentaire est automatiquement gÃ©nÃ©rÃ©

2. **Ouvrir le navigateur** :

   - Aller sur `http://localhost:3000`
   - Un nouveau commentaire se gÃ©nÃ¨re automatiquement
   - Observer le statut dans l'interface

3. **RÃ©gÃ©nÃ©rer si nÃ©cessaire** :

   - Cliquer sur "RÃ©gÃ©nÃ©rer" dans l'interface
   - Ou rafraÃ®chir la page (F5)

4. **Exporter la vidÃ©o** :
   ```bash
   npm run render
   ```
   â†³ La vidÃ©o utilise automatiquement le dernier commentaire gÃ©nÃ©rÃ©

## ğŸ’¡ Conseils

- **DÃ©veloppement** : Le commentaire change Ã  chaque rafraÃ®chissement, parfait pour tester diffÃ©rents styles
- **Production** : GÃ©nÃ©rez un commentaire final avec `npm run generate:comment` avant le rendu final
- **Personnalisation** : Modifiez les listes de pseudos/commentaires dans `tiktok-comment-generator.ts`
